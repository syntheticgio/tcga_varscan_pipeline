<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">// GLOBAL VARIABLES</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="COMM">// ----------------</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="COMM">// These variables are setting the defaults for</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="COMM">// the user defined variables.</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="COMM">/** @global */</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MIN_TEMP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Minimum temperature allowed</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MAX_TEMP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">// Maximum temperature allowed</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MIN_AMP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Minimum amplification size allowed</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MAX_AMP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Maximum amplification size allowed</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MIN_PERCENT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Minimum percentage recoded allowed</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MAX_PERCENT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Maximum percentage recoded allowed</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">NUCLEOTIDES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="STRN">'c'</span><span class="PUNC">,</span><span class="STRN">'g'</span><span class="PUNC">,</span><span class="STRN">'t'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Nucleotides supported</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">GENE_BEGINING</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">GENE_END</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">KMER_SIZE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">24</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">NA_CONCENTRATION</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Can become an advanced parameter</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">FIRST_NUC_SUB_SCORE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Score value if there is a substitution possible on the first nucleotide of the codon</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">SECOND_NUC_SUB_SCORE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Score value if there is a substitution possible on the second nucleotide of the codon</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">THIRD_NUC_SUB_SCORE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Score value if there is a substitution possible on the third nucleotide of the codon</span><span class="WHIT">
<span class='line'> 25</span> 
<span class='line'> 26</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="COMM">// This is the default standard amino acid table</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="COMM">// set as a global variable</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="COMM">/** @global */</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">AA_TABLE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">	</span><span class="NAME">A</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GCT"</span><span class="PUNC">,</span><span class="STRN">"GCC"</span><span class="PUNC">,</span><span class="STRN">"GCA"</span><span class="PUNC">,</span><span class="STRN">"GCG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">	</span><span class="NAME">R</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AGA"</span><span class="PUNC">,</span><span class="STRN">"AGG"</span><span class="PUNC">,</span><span class="STRN">"CGT"</span><span class="PUNC">,</span><span class="STRN">"CGC"</span><span class="PUNC">,</span><span class="STRN">"CGA"</span><span class="PUNC">,</span><span class="STRN">"CGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">	</span><span class="NAME">N</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AAT"</span><span class="PUNC">,</span><span class="STRN">"AAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">	</span><span class="NAME">D</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GAT"</span><span class="PUNC">,</span><span class="STRN">"GAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="WHIT">	</span><span class="NAME">C</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TGT"</span><span class="PUNC">,</span><span class="STRN">"TGC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="WHIT">	</span><span class="NAME">Q</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CAA"</span><span class="PUNC">,</span><span class="STRN">"CAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="WHIT">	</span><span class="NAME">E</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GAA"</span><span class="PUNC">,</span><span class="STRN">"GAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="WHIT">	</span><span class="NAME">G</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GGT"</span><span class="PUNC">,</span><span class="STRN">"GGA"</span><span class="PUNC">,</span><span class="STRN">"GGC"</span><span class="PUNC">,</span><span class="STRN">"GGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="WHIT">	</span><span class="NAME">H</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CAT"</span><span class="PUNC">,</span><span class="STRN">"CAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="WHIT">	</span><span class="NAME">I</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ATT"</span><span class="PUNC">,</span><span class="STRN">"ATC"</span><span class="PUNC">,</span><span class="STRN">"ATA"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="WHIT">	</span><span class="NAME">L</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TTA"</span><span class="PUNC">,</span><span class="STRN">"TTG"</span><span class="PUNC">,</span><span class="STRN">"CTT"</span><span class="PUNC">,</span><span class="STRN">"CTC"</span><span class="PUNC">,</span><span class="STRN">"CTA"</span><span class="PUNC">,</span><span class="STRN">"CTG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">	</span><span class="NAME">K</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AAA"</span><span class="PUNC">,</span><span class="STRN">"AAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="WHIT">	</span><span class="NAME">M</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ATG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="WHIT">	</span><span class="NAME">F</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TTT"</span><span class="PUNC">,</span><span class="STRN">"TTC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="WHIT">	</span><span class="NAME">P</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CCT"</span><span class="PUNC">,</span><span class="STRN">"CCC"</span><span class="PUNC">,</span><span class="STRN">"CCA"</span><span class="PUNC">,</span><span class="STRN">"CCG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="WHIT">	</span><span class="NAME">S</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AGT"</span><span class="PUNC">,</span><span class="STRN">"AGC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="WHIT">	</span><span class="NAME">T</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ACT"</span><span class="PUNC">,</span><span class="STRN">"ACC"</span><span class="PUNC">,</span><span class="STRN">"ACA"</span><span class="PUNC">,</span><span class="STRN">"ACG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="WHIT">	</span><span class="NAME">W</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="WHIT">	</span><span class="NAME">Y</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TAT"</span><span class="PUNC">,</span><span class="STRN">"TAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="WHIT">	</span><span class="NAME">V</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GTT"</span><span class="PUNC">,</span><span class="STRN">"GTC"</span><span class="PUNC">,</span><span class="STRN">"GTA"</span><span class="PUNC">,</span><span class="STRN">"GTG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="WHIT">	</span><span class="NAME">STOP</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TAA"</span><span class="PUNC">,</span><span class="STRN">"TAG"</span><span class="PUNC">,</span><span class="STRN">"TGA"</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 56</span> 
<span class='line'> 57</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="COMM">// Default codon table (human)</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 62</span> </span><span class="COMM">/** @global */</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">CODON_TABLE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="WHIT">	</span><span class="NAME">AAA</span><span class="PUNC">:</span><span class="STRN">"K"</span><span class="PUNC">,</span><span class="NAME">AAC</span><span class="PUNC">:</span><span class="STRN">"N"</span><span class="PUNC">,</span><span class="NAME">AAG</span><span class="PUNC">:</span><span class="STRN">"K"</span><span class="PUNC">,</span><span class="NAME">AAT</span><span class="PUNC">:</span><span class="STRN">"N"</span><span class="PUNC">,</span><span class="NAME">TTT</span><span class="PUNC">:</span><span class="STRN">"F"</span><span class="PUNC">,</span><span class="NAME">TTC</span><span class="PUNC">:</span><span class="STRN">"F"</span><span class="PUNC">,</span><span class="NAME">TTA</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">TTG</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTT</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTC</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTA</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTG</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="WHIT">	</span><span class="NAME">ATT</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATC</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATA</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATG</span><span class="PUNC">:</span><span class="STRN">"M"</span><span class="PUNC">,</span><span class="NAME">GTT</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTC</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTA</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTG</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">TCT</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCC</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCA</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCG</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="WHIT">	</span><span class="NAME">CCT</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCC</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCA</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCG</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">ACT</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACC</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACA</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACG</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">GCT</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCC</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCA</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCG</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="WHIT">	</span><span class="NAME">TAT</span><span class="PUNC">:</span><span class="STRN">"Y"</span><span class="PUNC">,</span><span class="NAME">TAC</span><span class="PUNC">:</span><span class="STRN">"Y"</span><span class="PUNC">,</span><span class="NAME">TAA</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">TAG</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">CAT</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">,</span><span class="NAME">CAC</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">,</span><span class="NAME">CAA</span><span class="PUNC">:</span><span class="STRN">"Q"</span><span class="PUNC">,</span><span class="NAME">CAG</span><span class="PUNC">:</span><span class="STRN">"Q"</span><span class="PUNC">,</span><span class="NAME">GAT</span><span class="PUNC">:</span><span class="STRN">"D"</span><span class="PUNC">,</span><span class="NAME">GAC</span><span class="PUNC">:</span><span class="STRN">"D"</span><span class="PUNC">,</span><span class="NAME">GAA</span><span class="PUNC">:</span><span class="STRN">"E"</span><span class="PUNC">,</span><span class="NAME">GAG</span><span class="PUNC">:</span><span class="STRN">"E"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="WHIT">	</span><span class="NAME">TGT</span><span class="PUNC">:</span><span class="STRN">"C"</span><span class="PUNC">,</span><span class="NAME">TGC</span><span class="PUNC">:</span><span class="STRN">"C"</span><span class="PUNC">,</span><span class="NAME">TGA</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">TGG</span><span class="PUNC">:</span><span class="STRN">"W"</span><span class="PUNC">,</span><span class="NAME">CGT</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGC</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGA</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGG</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">AGT</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">AGC</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">AGA</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">AGG</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="WHIT">	</span><span class="NAME">GGT</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGC</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGA</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGG</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> 
<span class='line'> 72</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="COMM">// GLOBAL FUNCTIONS</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="COMM">// ----------------</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="COMM">// These are documented via jsdoc</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="COMM">// *********************************************</span><span class="WHIT">
<span class='line'> 79</span> 
<span class='line'> 80</span> 
<span class='line'> 81</span> </span><span class="COMM">/**
<span class='line'> 82</span>  * Core functionality for generating watermarks
<span class='line'> 83</span>  * 
<span class='line'> 84</span>  */</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">calculateWatermarks</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="WHIT">	
<span class='line'> 87</span> 		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="WHIT">		  </span><span class="COMM">// Call for the set of validation functions to make sure</span><span class="WHIT">
<span class='line'> 89</span> </span><span class="WHIT">		  </span><span class="COMM">// all parameters are acceptable.</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="WHIT">		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateAll</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">failed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"DEVELOPER: Failed form validation."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 95</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"DEVELOPER: Passed form validation."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="WHIT">	
<span class='line'> 99</span> 		  </span><span class="COMM">// **************************************************************** </span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">		  </span><span class="COMM">// Grab the different form entries now that everything is validated</span><span class="WHIT">
<span class='line'>101</span> </span><span class="WHIT">		  </span><span class="COMM">// ****************************************************************</span><span class="WHIT">
<span class='line'>102</span> </span><span class="WHIT">		
<span class='line'>103</span> 		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>104</span> </span><span class="WHIT">		  </span><span class="COMM">// Grab the genomic sequence from the form</span><span class="WHIT">
<span class='line'>105</span> </span><span class="WHIT">		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>106</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">genomic_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"genomic_sequence"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>107</span> </span><span class="WHIT">		</span><span class="NAME">genomic_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">genomic_sequence.replace</span><span class="PUNC">(</span><span class="REGX">/(" "|\r\n|\n|\r)/gm</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">		  </span><span class="COMM">// Create the parts of the genome that are going to be tested</span><span class="WHIT">
<span class='line'>109</span> </span><span class="WHIT">		  </span><span class="COMM">// This will change the nucleotide sequence to toUpperCase</span><span class="WHIT">
<span class='line'>110</span> </span><span class="WHIT">		  </span><span class="COMM">// and remove spaces</span><span class="WHIT">
<span class='line'>111</span> </span><span class="WHIT">		  </span><span class="COMM">// #WARNING - should add replacement of U to T here?</span><span class="WHIT">
<span class='line'>112</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">genomic_sequence.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span> </span><span class="WHIT">		</span><span class="NAME">truncated_genomic_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.replace</span><span class="PUNC">(</span><span class="REGX">/\s+/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span> </span><span class="WHIT">		
<span class='line'>115</span> 		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">		  </span><span class="COMM">// Grab the additional variables from the HTML form.</span><span class="WHIT">
<span class='line'>117</span> </span><span class="WHIT">		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>118</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">minimum_melting_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"minimum_melting_temp"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>119</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maximum_melting_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"maximum_melting_temp"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">minimum_amplification</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"minimum_amplification"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maximum_amplification</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"maximum_amplification"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">minimum_recoded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"minimum_recoded"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>123</span> 
<span class='line'>124</span> </span><span class="WHIT">		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>125</span> </span><span class="WHIT">		  </span><span class="COMM">// Get organism type</span><span class="WHIT">
<span class='line'>126</span> </span><span class="WHIT">		  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>127</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">organism</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"organism"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>128</span> </span><span class="WHIT">		  </span><span class="COMM">// Set the organism codon table</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">		</span><span class="NAME">setCodonTable</span><span class="PUNC">(</span><span class="NAME">organism</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>130</span> </span><span class="WHIT">		
<span class='line'>131</span> 		
<span class='line'>132</span> 		  </span><span class="COMM">// Convert triplets to amino acids</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">		  </span><span class="COMM">// Need codon table</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">		  </span><span class="COMM">// Start grabbing triplets and deciding the level of change allowed.</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">full_map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>136</span> </span><span class="WHIT">		
<span class='line'>137</span> 		  </span><span class="COMM">// Loop through the sequences and create the codon table _map</span><span class="WHIT">
<span class='line'>138</span> </span><span class="WHIT">		  </span><span class="COMM">// Can call amino acid via codon or call codons via amino acid</span><span class="WHIT">
<span class='line'>139</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">truncated_genomic_sequence.length</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_codon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.substring</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_codon.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">			
<span class='line'>143</span> 			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_aa</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CODON_TABLE</span><span class="PUNC">[</span><span class="NAME">_codon</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>145</span> </span><span class="WHIT">					    </span><span class="NAME">codon</span><span class="PUNC">:</span><span class="NAME">_codon</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>146</span> </span><span class="WHIT">					    </span><span class="NAME">aa</span><span class="PUNC">:</span><span class="NAME">_aa</span><span class="WHIT">
<span class='line'>147</span> </span><span class="WHIT">					    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">			</span><span class="NAME">full_map.push</span><span class="PUNC">(</span><span class="NAME">_map</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">		
<span class='line'>151</span> 		  </span><span class="COMM">// Generate kmers</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">		  </span><span class="COMM">// Each kmer should get a score</span><span class="WHIT">
<span class='line'>153</span> </span><span class="WHIT">		
<span class='line'>154</span> 		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">kmer_map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">kmer_counter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">meltingTempCount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">percentChangedCount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">		
<span class='line'>160</span> 		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">full_map.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">			</span><span class="NAME">kmer_map.push</span><span class="PUNC">(</span><span class="NAME">full_map</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_map.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">KMER_SIZE</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>163</span> </span><span class="WHIT">				</span><span class="NAME">kmer_map.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>164</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>165</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_map.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">KMER_SIZE</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>166</span> </span><span class="WHIT">				</span><span class="COMM">// Have a kmer of length KMER_SIZE</span><span class="WHIT">
<span class='line'>167</span> </span><span class="WHIT">				</span><span class="COMM">// Need to determine a score</span><span class="WHIT">
<span class='line'>168</span> </span><span class="WHIT">				</span><span class="COMM">// Also need new nucleotides that match the score</span><span class="WHIT">
<span class='line'>169</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">new_kmer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>170</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">counter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>171</span> 
<span class='line'>172</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">kmer_map.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_all_codons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AA_TABLE</span><span class="PUNC">[</span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">aa</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">top_score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">score</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">codon</span><span class="PUNC">:</span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">					</span><span class="COMM">//console.log(i);</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">k</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">_all_codons.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">						</span><span class="COMM">// Compare current codon with other codons</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">						</span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">						
<span class='line'>181</span> 						</span><span class="COMM">// Third nucleotide</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">_all_codons</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">							</span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">THIRD_NUC_SUB_SCORE</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>184</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">						</span><span class="COMM">// Second nucleotide</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">_all_codons</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>187</span> </span><span class="WHIT">							</span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">SECOND_NUC_SUB_SCORE</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">						</span><span class="COMM">// First nucleotide</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">_all_codons</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>191</span> </span><span class="WHIT">							</span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">FIRST_NUC_SUB_SCORE</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>193</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">top_score.score</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>194</span> </span><span class="WHIT">							</span><span class="NAME">top_score.score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">score</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>195</span> </span><span class="WHIT">							</span><span class="NAME">top_score.position</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>196</span> </span><span class="WHIT">							</span><span class="NAME">top_score.codon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_all_codons</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>198</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>199</span> </span><span class="WHIT">					</span><span class="COMM">// Looped through all possible codons; have scores</span><span class="WHIT">
<span class='line'>200</span> </span><span class="WHIT">					</span><span class="COMM">// Build new kmer with highest scoring triplets</span><span class="WHIT">
<span class='line'>201</span> </span><span class="WHIT">					</span><span class="NAME">new_kmer</span><span class="PUNC">[</span><span class="NAME">counter</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">top_score</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">					</span><span class="NAME">counter</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">triplets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">total_score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>206</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">new_kmer_string</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old_kmer_string</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">				
<span class='line'>209</span> 				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ii</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">ii</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">new_kmer.length</span><span class="PUNC">;</span><span class="NAME">ii</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>210</span> </span><span class="WHIT">					</span><span class="NAME">triplets.push</span><span class="PUNC">(</span><span class="NAME">new_kmer</span><span class="PUNC">[</span><span class="NAME">ii</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>211</span> </span><span class="WHIT">					</span><span class="NAME">new_kmer_string</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">new_kmer_string</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">new_kmer</span><span class="PUNC">[</span><span class="NAME">ii</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">					</span><span class="NAME">total_score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">total_score</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">new_kmer</span><span class="PUNC">[</span><span class="NAME">ii</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">score</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>213</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>214</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ii</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">ii</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">kmer_map.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">ii</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">					</span><span class="NAME">old_kmer_string</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">old_kmer_string</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">kmer_map</span><span class="PUNC">[</span><span class="NAME">ii</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">codon</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">				
<span class='line'>218</span> 				</span><span class="COMM">// determine melting temperature for the kmer, and filter</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">melting_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">determineMeltingTemperature</span><span class="PUNC">(</span><span class="NAME">new_kmer_string</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">melting_temp</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">minimum_melting_temp</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">melting_temp</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">maximum_melting_temp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">				  </span><span class="NAME">meltingTempCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">				  </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">				
<span class='line'>225</span> 				</span><span class="COMM">// determine percentage of sequence changed and filter</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">percent_changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">determinePercentageChanged</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">new_kmer_string</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">old_kmer_string</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">percent_changed</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">minimum_recoded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>228</span> </span><span class="WHIT">				  </span><span class="NAME">percentChangedCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>229</span> </span><span class="WHIT">				  </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>230</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>231</span> </span><span class="WHIT">				
<span class='line'>232</span> 				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">kscore</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>233</span> </span><span class="WHIT">							</span><span class="NAME">start_codon</span><span class="PUNC">:</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">KMER_SIZE</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">							</span><span class="NAME">start_codon_position</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">KMER_SIZE</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">							</span><span class="NAME">end_codon</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">							</span><span class="NAME">end_codon_position</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">							</span><span class="NAME">size</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">KMER_SIZE</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">							</span><span class="NAME">codons</span><span class="PUNC">:</span><span class="NAME">triplets</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">							</span><span class="NAME">score</span><span class="PUNC">:</span><span class="NAME">total_score</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>240</span> </span><span class="WHIT">							</span><span class="NAME">mt</span><span class="PUNC">:</span><span class="NAME">melting_temp</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">							</span><span class="NAME">pc</span><span class="PUNC">:</span><span class="NAME">percent_changed</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">				</span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">kmer_counter</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kscore</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span> </span><span class="WHIT">				</span><span class="NAME">kmer_counter</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">		
<span class='line'>247</span> 		</span><span class="COMM">//i++;</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">		
<span class='line'>250</span> 		</span><span class="COMM">// Check the kmer count</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">		</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"KmerCount: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">kmer_counter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">		
<span class='line'>253</span> 		</span><span class="COMM">// Have all the filtered kmers</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">		</span><span class="COMM">// need to determine which ones are proper distance apart with highest score</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">		
<span class='line'>256</span> 		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>257</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_score</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">kmer_scores.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>259</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">kmer_scores.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">				  </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_combined</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">score</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">score</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_distance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i_left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start_codon_position</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">end_codon_position</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">				  </span><span class="NAME">_distance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">end_codon_position</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start_codon_position</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">				  </span><span class="COMM">//_distance = ( kmer_scores[i].start_codon_position * 3 + KMER_SIZE ) - ( kmer_scores[j].start_codon_position * 3 );</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">				  </span><span class="NAME">_distance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">end_codon_position</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start_codon_position</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">				  </span><span class="NAME">i_left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_distance</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">maximum_amplification</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='line'>273</span> 				  </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">				
<span class='line'>275</span> 				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_combined</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">_score</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">_distance</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">minimum_amplification</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_combined</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">_score</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">						</span><span class="COMM">// Higher score found</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">						</span><span class="NAME">highest_scores.length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i_left</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>281</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_highest</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>282</span> </span><span class="WHIT">							</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>283</span> </span><span class="WHIT">							</span><span class="NAME">right</span><span class="PUNC">:</span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>284</span> </span><span class="WHIT">							</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">_distance</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">						</span><span class="COMM">// start:kmer_scores[j].start_codon_position</span><span class="WHIT">
<span class='line'>287</span> 
<span class='line'>288</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>289</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_highest</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>290</span> </span><span class="WHIT">							</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>291</span> </span><span class="WHIT">							</span><span class="NAME">right</span><span class="PUNC">:</span><span class="NAME">kmer_scores</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>292</span> </span><span class="WHIT">							</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">_distance</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">						</span><span class="COMM">// start:kmer_scores[j].start_codon_position</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">					</span><span class="NAME">highest_scores.push</span><span class="PUNC">(</span><span class="NAME">_highest</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">		
<span class='line'>301</span> 		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">highest_scores.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">			
<span class='line'>302</span> 			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"&lt;p class=\"nucleotides\">"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"&lt;p class=\"nucleotides\">"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newLeftCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">			
<span class='line'>306</span> 			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.codons.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">						</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">				</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.codons</span><span class="PUNC">[</span><span class="NAME">jj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">				</span><span class="NAME">newLeftCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newLeftCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.codons</span><span class="PUNC">[</span><span class="NAME">jj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\">Pos Start: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.start_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Pos End: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Score: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>320</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.score</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Temp: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.mt</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Changed: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.pc.toFixed</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">			</span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" %&lt;/p>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">"#left_watermark"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">left_html</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>327</span> </span><span class="WHIT">			
<span class='line'>328</span> 			</span><span class="COMM">// Write the nucleotides up to the first watermark and then the left watermark in bold/color			</span><span class="WHIT">
<span class='line'>329</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">start_pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.start_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>330</span> </span><span class="WHIT">			</span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">start_pos</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;b style=\"color: blue\">"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">newLeftCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/b>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>331</span> </span><span class="WHIT">			
<span class='line'>332</span> 			</span><span class="COMM">// Write right watermark			</span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newRightCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"&lt;p class=\"nucleotides\">"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.codons.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">jj</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">jj</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">						</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">				</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.codons</span><span class="PUNC">[</span><span class="NAME">jj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>342</span> </span><span class="WHIT">				</span><span class="NAME">newRightCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newRightCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.codons</span><span class="PUNC">[</span><span class="NAME">jj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>344</span> </span><span class="WHIT">			
<span class='line'>345</span> 			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\">Pos Start: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>346</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.start_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>347</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Pos End: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>348</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.end_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>349</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Score: &nbsp&lt;p class=\"left results_output\"> &nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>350</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.score</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Temp: &nbsp&lt;p class=\"left results_output\">&nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>352</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.mt</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/p>&lt;p class=\"left results_label\"> &nbsp| Changed: &nbsp&lt;p class=\"left results_output\">&nbsp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.pc.toFixed</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>355</span> </span><span class="WHIT">			</span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">right_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" %&lt;/p>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>356</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">"#right_watermark"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">right_html</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>357</span> </span><span class="WHIT">			
<span class='line'>358</span> 			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_diff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.start_codon_position</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>359</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_final_diff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.end_codon_position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>360</span> </span><span class="WHIT">			</span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.substring</span><span class="PUNC">(</span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon_position</span><span class="PUNC">,</span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon_position</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_diff</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;b style=\"color: blue\">"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">newRightCodonsNoSpace</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/b>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>361</span> </span><span class="WHIT">			</span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">full_results_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">truncated_genomic_sequence.substring</span><span class="PUNC">(</span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.end_codon_position</span><span class="PUNC">,</span><span class="NAME">truncated_genomic_sequence.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">						
<span class='line'>363</span> 			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">"#full_watermark"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">full_results_html</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>364</span> </span><span class="WHIT">			
<span class='line'>365</span> 			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Left: "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tCodon Start: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.start_codon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPosition Start: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.start_codon_position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>368</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tCodon End: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPosition End: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.end_codon_position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>370</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tSize: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tTriplets: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.codons</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>372</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tScore: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.score</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>373</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tMelting Point: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.mt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>374</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPercent Changed: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">left.pc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>375</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Right: "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tCodon Start: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.start_codon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>378</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPosition Start: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.start_codon_position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>379</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tCodon End: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.end_codon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>380</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPosition End: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.end_codon_position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>381</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tSize: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>382</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tTriplets: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.codons</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>383</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tScore: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.score</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>384</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tMelting Point: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.mt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>385</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"\tPercent Changed: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">right.pc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>386</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Distance: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">highest_scores</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">			
<span class='line'>389</span> 		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">		
<span class='line'>391</span> 		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">highest_scores.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">			</span><span class="COMM">// No results</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">		    
<span class='line'>394</span> 			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">no_results_html</span><span class="PUNC">=</span><span class="STRN">"&lt;p>No watermarks found within the current parameters.&lt;/p>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>395</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">meltingTempCount</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">percentChangedCount</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>396</span> </span><span class="WHIT">				</span><span class="NAME">no_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">no_results_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;p>Mimimum percentage of nucleotides may be set too high for results.&lt;/p>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">				</span><span class="NAME">no_results_html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">no_results_html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;p>Melting temperature range may be set too narrow for results..&lt;/p>"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">			
<span class='line'>401</span> 			</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'no_results'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">no_results_html</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>402</span> 			</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'no_results'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'visible'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">			</span><span class="COMM">// Show tutorial:</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">			</span><span class="NAME">generateTutorial</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="COMM">// End of function</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">	
<span class='line'>409</span> 	
<span class='line'>410</span> </span><span class="COMM">// ----------------------------------------------------------</span><span class="WHIT">
<span class='line'>411</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>412</span> </span><span class="COMM">// Support Functions</span><span class="WHIT">
<span class='line'>413</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>414</span> </span><span class="COMM">// ----------------------------------------------------------</span><span class="WHIT">
<span class='line'>415</span> 
<span class='line'>416</span> </span><span class="COMM">/*
<span class='line'>417</span> 	function log10(val) {
<span class='line'>418</span>   		return Math.log(val) / Math.LN10;
<span class='line'>419</span> 	}
<span class='line'>420</span> */</span><span class="WHIT">	
<span class='line'>421</span> 
<span class='line'>422</span> 
<span class='line'>423</span> 	</span><span class="COMM">/**
<span class='line'>424</span> 	 * Determine the meltring temperature for a KMER based on
<span class='line'>425</span> 	 * the different type of nucleotides and using the equation 
<span class='line'>426</span> 	 * from www.basic.northwestern.edu/biotools/oligocalc.html
<span class='line'>427</span> 	 * @author JackFrost2199
<span class='line'>428</span> 	 * @param {string} kmer_string - The string representing the nucleotide sequence that should be used to generate a melting temperature.
<span class='line'>429</span> 	 * 
<span class='line'>430</span> 	 */</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">determineMeltingTemperature</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_string</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wA</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kmer_string.split</span><span class="PUNC">(</span><span class="STRN">"A"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">zC</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kmer_string.split</span><span class="PUNC">(</span><span class="STRN">"C"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">yG</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kmer_string.split</span><span class="PUNC">(</span><span class="STRN">"G"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">xT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kmer_string.split</span><span class="PUNC">(</span><span class="STRN">"T"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>436</span> </span><span class="WHIT">		
<span class='line'>437</span> 		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Tm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>438</span> </span><span class="WHIT">		
<span class='line'>439</span> 		</span><span class="COMM">// Using equation from www.basic.northwestern.edu/biotools/oligocalc.html		</span><span class="WHIT">
<span class='line'>440</span> 
<span class='line'>441</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">kmer_string</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">13</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>442</span> </span><span class="WHIT">			</span><span class="NAME">Tm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">64.9</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">41</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">yG</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">zC</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">16.4</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wA</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">xT</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">yG</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">zC</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>443</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>444</span> </span><span class="WHIT">			</span><span class="NAME">Tm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wA</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">xT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">yG</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">zC</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">	
<span class='line'>447</span> 		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Tm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">	
<span class='line'>450</span> 	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">determinePercentageChanged</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">new_kmer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">old_kmer</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">new_kmer.length</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">old_kmer.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"DEVELOPER: new kmer length does not match old kmer length"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>454</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>455</span> </span><span class="WHIT">		
<span class='line'>456</span> 		</span><span class="COMM">// determine percentage difference here</span><span class="WHIT">
<span class='line'>457</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">match</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>458</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mismatch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">total</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">old_kmer.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">		
<span class='line'>461</span> 		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">old_kmer.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">old_kmer</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">new_kmer</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">match</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">mismatch</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">		
<span class='line'>466</span> 		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">variation_percentage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mismatch</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">old_kmer.length</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">variation_percentage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">	
<span class='line'>470</span> </span><span class="COMM">// ----------------------------------------------------------</span><span class="WHIT">
<span class='line'>471</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>472</span> </span><span class="COMM">// VALIDATIONS</span><span class="WHIT">
<span class='line'>473</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>474</span> </span><span class="COMM">// ----------------------------------------------------------</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateAll</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">		</span><span class="COMM">// Validate all blocks; generate any errors</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>479</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">submitted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>480</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>481</span> </span><span class="WHIT">	
<span class='line'>482</span> 		</span><span class="COMM">// Make sure minimum melting temperature is a valid number in a valid range</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#minimum_melting_temp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateMeltingTemperature</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>486</span> 
<span class='line'>487</span> </span><span class="WHIT">		</span><span class="COMM">// Make sure maximum melting temperature is a valid number in a valid range</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#maximum_melting_temp"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateMeltingTemperature</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>491</span> </span><span class="WHIT">	
<span class='line'>492</span> 		</span><span class="COMM">// Make sure the melting temperature range is valid</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"#minimum_melting_temp"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"#maximum_melting_temp"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateMeltingTemperatureRanges</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span> </span><span class="WHIT">	
<span class='line'>497</span> 		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#minimum_recoded"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>498</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateMinimumPercentageRecoded</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span> 
<span class='line'>501</span> </span><span class="WHIT">		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#minimum_amplification"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateAmplificationRegion</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">	
<span class='line'>505</span> 		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#maximum_amplification"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateAmplificationRegion</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>507</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span> </span><span class="WHIT">		
<span class='line'>509</span> 		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"#minimum_amplification"</span><span class="PUNC">,</span><span class="STRN">"#maximum_amplification"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>510</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateAmplificationRange</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>512</span> </span><span class="WHIT">		
<span class='line'>513</span> 		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#genomic_sequence"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateGenomeSequence</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>516</span> 
<span class='line'>517</span> 		</span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"#genomic_sequence"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"#minimum_amplification"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>518</span> </span><span class="WHIT">		</span><span class="NAME">_valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">validateGenomeLength</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>519</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_valid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>520</span> </span><span class="WHIT">		
<span class='line'>521</span> 		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">failed</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>522</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>523</span> 
<span class='line'>524</span> </span><span class="COMM">/**
<span class='line'>525</span>  * Generically set properties of error messages based on the input
<span class='line'>526</span>  * @author JackFrost2199
<span class='line'>527</span>  * @param {Bool} submitted - Whether or not the computation has been submittted
<span class='line'>528</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>529</span>  * 
<span class='line'>530</span>  */</span><span class="WHIT">
<span class='line'>531</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>532</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="STRN">"#error_alert"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="STRN">"display"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"block"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>533</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">$.isArray</span><span class="PUNC">(</span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">error_id.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="STRN">"display"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"block"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>536</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_label"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"error"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>537</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">	
<span class='line'>538</span> 	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="STRN">"display"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"block"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_label"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"error"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>541</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>542</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>543</span> 
<span class='line'>544</span> </span><span class="COMM">/**
<span class='line'>545</span>  * Determine if the temperature predicted is between the MIN_TEMP and the MAX_TEMP and is a number
<span class='line'>546</span>  * @author JackFrost2199
<span class='line'>547</span>  * @param {Bool} submitted - Whether or not the computation has been submittted
<span class='line'>548</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>549</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>550</span>  */</span><span class="WHIT">
<span class='line'>551</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateMeltingTemperature</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">	</span><span class="COMM">//var _minimum_melting_temp = document.getElementById("minimum_melting_temp").value;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_melting_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">_melting_temp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Temperature must be a number."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">_melting_temp</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">MIN_TEMP</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">_melting_temp</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">MAX_TEMP</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Value must be a number between "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MIN_TEMP</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" and "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MAX_TEMP</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" ."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Meets all requirements so return true</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">	
<span class='line'>560</span> 	</span><span class="COMM">// Set all appropriate error flags</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>564</span> 
<span class='line'>565</span> </span><span class="COMM">/**
<span class='line'>566</span>  * Validate that the melting temperatures are appropriately spaced (ie. minimum is not larger than maximum)
<span class='line'>567</span>  * @author JackFrost2199
<span class='line'>568</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>569</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>570</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>571</span>  */</span><span class="WHIT">
<span class='line'>572</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateMeltingTemperatureRanges</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>573</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_min_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_max_temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>575</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_min_temp</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">_max_temp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>576</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Value must be less than or equal to maximum temperature."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>577</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Value must be greater than or equal to minimum temperature."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>578</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>579</span> 
<span class='line'>580</span> </span><span class="WHIT">	</span><span class="COMM">// Set all appropriate error flags</span><span class="WHIT">
<span class='line'>581</span> </span><span class="WHIT">	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>584</span> 
<span class='line'>585</span> </span><span class="COMM">/**
<span class='line'>586</span>  * Validate the the minimum percentage of recoded required is between 0 and 100
<span class='line'>587</span>  * @author JackFrost2199
<span class='line'>588</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>589</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>590</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>591</span>  */</span><span class="WHIT">
<span class='line'>592</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateMinimumPercentageRecoded</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>593</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_minimum_recoded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>594</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">_minimum_recoded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>595</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Percentage must be a number."</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>596</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_minimum_recoded</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">MIN_PERCENT</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">_minimum_recoded</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">MAX_PERCENT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Percentage must be between "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MIN_PERCENT</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"% and "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MAX_PERCENT</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"%."</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">	
<span class='line'>600</span> 	</span><span class="COMM">// Set all appropriate error flags</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>603</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>604</span> 
<span class='line'>605</span> </span><span class="COMM">/**
<span class='line'>606</span>  * Make sure amplification values are valid (is a number and is between the hard Minimum and Maximum
<span class='line'>607</span>  * amplification sizes.
<span class='line'>608</span>  * @author JackFrost2199
<span class='line'>609</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>610</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>611</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>612</span>  */</span><span class="WHIT">
<span class='line'>613</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateAmplificationRegion</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_amplification</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">_amplification</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Region size must be a number."</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_amplification</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">MIN_AMP</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Region size must be at least "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MIN_AMP</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" nucleotides."</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>619</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_amplification</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">MAX_AMP</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Region size must be no larger than "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">MAX_AMP</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" nucleotides."</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">	
<span class='line'>623</span> 	</span><span class="COMM">// Set all appropriate error flags</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>626</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>627</span> 
<span class='line'>628</span> </span><span class="COMM">/**
<span class='line'>629</span>  * Make sure amplification size range is a positive number
<span class='line'>630</span>  * @author JackFrost2199
<span class='line'>631</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>632</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>633</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>634</span>  */</span><span class="WHIT">
<span class='line'>635</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateAmplificationRange</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_min_amp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_max_amp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_min_amp</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">_max_amp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>639</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Value must be less than or equal to largest amplification region."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>640</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Value must be greater than or equal to smallest amplification region."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>642</span> 
<span class='line'>643</span> </span><span class="WHIT">	</span><span class="COMM">// Set all appropriate error flags</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>646</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>647</span> 
<span class='line'>648</span> </span><span class="COMM">/**
<span class='line'>649</span>  * Validate that the genomic information is valid
<span class='line'>650</span>  * @author JackFrost2199
<span class='line'>651</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>652</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>653</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>654</span>  */</span><span class="WHIT">
<span class='line'>655</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateGenomeSequence</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">	</span><span class="NAME">_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_sequence.replace</span><span class="PUNC">(</span><span class="REGX">/(\r\n|\n|\r|\s+)/gm</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span> 
<span class='line'>659</span> </span><span class="WHIT">	</span><span class="COMM">//DEBUG</span><span class="WHIT">
<span class='line'>660</span> </span><span class="WHIT">	</span><span class="COMM">//var dbg = _sequence.split("\n");</span><span class="WHIT">
<span class='line'>661</span> </span><span class="WHIT">	</span><span class="COMM">//console.log("Number of newlines: " + dbg.length);</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">		
<span class='line'>663</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">passed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">_sequence.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">NUCLEOTIDES.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_sequence</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">NUCLEOTIDES</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>668</span> </span><span class="WHIT">				</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>669</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>671</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">invalid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">			</span><span class="COMM">// Set error; there is an unsupported nucleotide</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">			</span><span class="NAME">passed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">passed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// No need to set errors</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">	
<span class='line'>680</span> 	</span><span class="COMM">// Print out nucleotides allowed</span><span class="WHIT">
<span class='line'>681</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_nuc_error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>682</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">NUCLEOTIDES.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">		</span><span class="NAME">_nuc_error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_nuc_error</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">NUCLEOTIDES</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">","</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">	</span><span class="NAME">_nuc_error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_nuc_error.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> </span><span class="WHIT">	
<span class='line'>687</span> 	</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Only nucleotides "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_nuc_error.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">	
<span class='line'>689</span> 	</span><span class="NAME">setErrors</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>691</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>692</span> 
<span class='line'>693</span> </span><span class="COMM">/**
<span class='line'>694</span>  * Validate Genome Length.  Determine if sequence length is too small for the minimum amplification
<span class='line'>695</span>  * @author JackFrost2199
<span class='line'>696</span>  * @param {Bool} submitted - Wheter or not the computation has been submitted
<span class='line'>697</span>  * @param {String} error_id - The DIV id that the error message should be placed in
<span class='line'>698</span>  * @returns {Bool} True if passes validation, false if it fails
<span class='line'>699</span>  * 
<span class='line'>700</span>  */</span><span class="WHIT">
<span class='line'>701</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">validateGenomeLength</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_sequence</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_min_amp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">val</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">	</span><span class="COMM">//if (_sequence.length &lt; (GENE_BEGINING + GENE_END + parseInt(_min_amp) + 50) ) {</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_sequence.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">_min_amp</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">		</span><span class="COMM">// Sequence length is too small for the minimum amplification</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">		
<span class='line'>708</span> 		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"_error"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="STRN">"Too few nucleotides in gene sequence.  Must be at least the size of the minimum amplification."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>709</span> </span><span class="WHIT">		</span><span class="NAME">setErrors</span><span class="PUNC">(</span><span class="NAME">submitted</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">error_id</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>711</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>712</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>713</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>714</span> 
<span class='line'>715</span> </span><span class="COMM">/**
<span class='line'>716</span>  * Set the codon table based on the organism.
<span class='line'>717</span>  *@param {string} organism - This is the organims that the codon table should be generated based off of
<span class='line'>718</span>  * 
<span class='line'>719</span>  */</span><span class="WHIT">
<span class='line'>720</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setCodonTable</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">organism</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">  </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">organism</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"mycobacterium"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">	</span><span class="COMM">// Mycobacterium smegmatis str. MC2 155 amino acid table</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">	</span><span class="NAME">AA_TABLE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">		</span><span class="NAME">A</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GCT"</span><span class="PUNC">,</span><span class="STRN">"GCC"</span><span class="PUNC">,</span><span class="STRN">"GCA"</span><span class="PUNC">,</span><span class="STRN">"GCG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>725</span> </span><span class="WHIT">		</span><span class="NAME">R</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AGA"</span><span class="PUNC">,</span><span class="STRN">"AGG"</span><span class="PUNC">,</span><span class="STRN">"CGT"</span><span class="PUNC">,</span><span class="STRN">"CGC"</span><span class="PUNC">,</span><span class="STRN">"CGA"</span><span class="PUNC">,</span><span class="STRN">"CGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">		</span><span class="NAME">N</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AAT"</span><span class="PUNC">,</span><span class="STRN">"AAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">		</span><span class="NAME">D</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GAT"</span><span class="PUNC">,</span><span class="STRN">"GAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">		</span><span class="NAME">C</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TGT"</span><span class="PUNC">,</span><span class="STRN">"TGC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">		</span><span class="NAME">Q</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CAA"</span><span class="PUNC">,</span><span class="STRN">"CAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">		</span><span class="NAME">E</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GAA"</span><span class="PUNC">,</span><span class="STRN">"GAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">		</span><span class="NAME">G</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GGT"</span><span class="PUNC">,</span><span class="STRN">"GGA"</span><span class="PUNC">,</span><span class="STRN">"GGC"</span><span class="PUNC">,</span><span class="STRN">"GGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">		</span><span class="NAME">H</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CAT"</span><span class="PUNC">,</span><span class="STRN">"CAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">		</span><span class="NAME">I</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ATT"</span><span class="PUNC">,</span><span class="STRN">"ATC"</span><span class="PUNC">,</span><span class="STRN">"ATA"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">		</span><span class="NAME">L</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TTA"</span><span class="PUNC">,</span><span class="STRN">"TTG"</span><span class="PUNC">,</span><span class="STRN">"CTT"</span><span class="PUNC">,</span><span class="STRN">"CTC"</span><span class="PUNC">,</span><span class="STRN">"CTA"</span><span class="PUNC">,</span><span class="STRN">"CTG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>735</span> </span><span class="WHIT">		</span><span class="NAME">K</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AAA"</span><span class="PUNC">,</span><span class="STRN">"AAG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>736</span> </span><span class="WHIT">		</span><span class="NAME">M</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ATG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">		</span><span class="NAME">F</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TTT"</span><span class="PUNC">,</span><span class="STRN">"TTC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">		</span><span class="NAME">P</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"CCT"</span><span class="PUNC">,</span><span class="STRN">"CCC"</span><span class="PUNC">,</span><span class="STRN">"CCA"</span><span class="PUNC">,</span><span class="STRN">"CCG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">		</span><span class="NAME">S</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"AGT"</span><span class="PUNC">,</span><span class="STRN">"AGC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">		</span><span class="NAME">T</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"ACT"</span><span class="PUNC">,</span><span class="STRN">"ACC"</span><span class="PUNC">,</span><span class="STRN">"ACA"</span><span class="PUNC">,</span><span class="STRN">"ACG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">		</span><span class="NAME">W</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TGG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">		</span><span class="NAME">Y</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TAT"</span><span class="PUNC">,</span><span class="STRN">"TAC"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">		</span><span class="NAME">V</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"GTT"</span><span class="PUNC">,</span><span class="STRN">"GTC"</span><span class="PUNC">,</span><span class="STRN">"GTA"</span><span class="PUNC">,</span><span class="STRN">"GTG"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">		</span><span class="NAME">STOP</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"TAA"</span><span class="PUNC">,</span><span class="STRN">"TAG"</span><span class="PUNC">,</span><span class="STRN">"TGA"</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>746</span> 
<span class='line'>747</span> </span><span class="WHIT">	</span><span class="COMM">// Mycobacterium smegmatis str. MC2 155 codon table</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">	</span><span class="NAME">CODON_TABLE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>749</span> </span><span class="WHIT">		</span><span class="NAME">AAA</span><span class="PUNC">:</span><span class="STRN">"K"</span><span class="PUNC">,</span><span class="NAME">AAC</span><span class="PUNC">:</span><span class="STRN">"N"</span><span class="PUNC">,</span><span class="NAME">AAG</span><span class="PUNC">:</span><span class="STRN">"K"</span><span class="PUNC">,</span><span class="NAME">AAT</span><span class="PUNC">:</span><span class="STRN">"N"</span><span class="PUNC">,</span><span class="NAME">TTT</span><span class="PUNC">:</span><span class="STRN">"F"</span><span class="PUNC">,</span><span class="NAME">TTC</span><span class="PUNC">:</span><span class="STRN">"F"</span><span class="PUNC">,</span><span class="NAME">TTA</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">TTG</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTT</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTC</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTA</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="NAME">CTG</span><span class="PUNC">:</span><span class="STRN">"L"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>750</span> </span><span class="WHIT">		</span><span class="NAME">ATT</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATC</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATA</span><span class="PUNC">:</span><span class="STRN">"I"</span><span class="PUNC">,</span><span class="NAME">ATG</span><span class="PUNC">:</span><span class="STRN">"M"</span><span class="PUNC">,</span><span class="NAME">GTT</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTC</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTA</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">GTG</span><span class="PUNC">:</span><span class="STRN">"V"</span><span class="PUNC">,</span><span class="NAME">TCT</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCC</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCA</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">TCG</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>751</span> </span><span class="WHIT">		</span><span class="NAME">CCT</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCC</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCA</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">CCG</span><span class="PUNC">:</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">ACT</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACC</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACA</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">ACG</span><span class="PUNC">:</span><span class="STRN">"T"</span><span class="PUNC">,</span><span class="NAME">GCT</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCC</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCA</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="NAME">GCG</span><span class="PUNC">:</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>752</span> </span><span class="WHIT">		</span><span class="NAME">TAT</span><span class="PUNC">:</span><span class="STRN">"Y"</span><span class="PUNC">,</span><span class="NAME">TAC</span><span class="PUNC">:</span><span class="STRN">"Y"</span><span class="PUNC">,</span><span class="NAME">TAA</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">TAG</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">CAT</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">,</span><span class="NAME">CAC</span><span class="PUNC">:</span><span class="STRN">"H"</span><span class="PUNC">,</span><span class="NAME">CAA</span><span class="PUNC">:</span><span class="STRN">"Q"</span><span class="PUNC">,</span><span class="NAME">CAG</span><span class="PUNC">:</span><span class="STRN">"Q"</span><span class="PUNC">,</span><span class="NAME">GAT</span><span class="PUNC">:</span><span class="STRN">"D"</span><span class="PUNC">,</span><span class="NAME">GAC</span><span class="PUNC">:</span><span class="STRN">"D"</span><span class="PUNC">,</span><span class="NAME">GAA</span><span class="PUNC">:</span><span class="STRN">"E"</span><span class="PUNC">,</span><span class="NAME">GAG</span><span class="PUNC">:</span><span class="STRN">"E"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>753</span> </span><span class="WHIT">		</span><span class="NAME">TGT</span><span class="PUNC">:</span><span class="STRN">"C"</span><span class="PUNC">,</span><span class="NAME">TGC</span><span class="PUNC">:</span><span class="STRN">"C"</span><span class="PUNC">,</span><span class="NAME">TGA</span><span class="PUNC">:</span><span class="STRN">"STOP"</span><span class="PUNC">,</span><span class="NAME">TGG</span><span class="PUNC">:</span><span class="STRN">"W"</span><span class="PUNC">,</span><span class="NAME">CGT</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGC</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGA</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">CGG</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">AGT</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">AGC</span><span class="PUNC">:</span><span class="STRN">"S"</span><span class="PUNC">,</span><span class="NAME">AGA</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="NAME">AGG</span><span class="PUNC">:</span><span class="STRN">"R"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">		</span><span class="NAME">GGT</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGC</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGA</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="PUNC">,</span><span class="NAME">GGG</span><span class="PUNC">:</span><span class="STRN">"G"</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>756</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>757</span> </span><span class="WHIT">	</span><span class="COMM">// Standard codon table is loaded by default already</span><span class="WHIT">
<span class='line'>758</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>759</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>760</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>761</span> 
<span class='line'>762</span> </span><span class="COMM">/**
<span class='line'>763</span>  * Generate the tutorial for use in Watermarker.
<span class='line'>764</span>  * This gives three walk through steps of the process
<span class='line'>765</span>  * so users can learn.  Recursive function that generates the tutorial hovers.
<span class='line'>766</span>  * @param {bool} tutorial_needed - Toggle whether or not the tutorial should be shown
<span class='line'>767</span>  * @param {int} tutorial_index - The index for whichever tutorial needs to be pushed out.
<span class='line'>768</span>  * 
<span class='line'>769</span>  */</span><span class="WHIT">
<span class='line'>770</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">generateTutorial</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tutorial_needed</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tutorial_index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>771</span> </span><span class="WHIT">  </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tutorial_needed</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='line'>772</span> 	</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>773</span> </span><span class="WHIT">  
<span class='line'>774</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tutorialHTML</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>775</span> </span><span class="WHIT">  </span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">tutorial_index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>776</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>777</span> </span><span class="WHIT">	  </span><span class="NAME">tutorialHTML</span><span class="PUNC">=</span><span class="STRN">"&lt;p>&lt;div class=\"center\">&lt;img src=\"img/first_header.png\" class=\"tutorial_header\">&lt;/div>&lt;div style=\"display:table;\">&lt;div style=\"float:right;\">&lt;img src=\"img/dna_small.png\" height=\"211\" width=\"100\">&lt;/img>&lt;/div>&lt;div class=\"tutorial_title\">&lt;br>Minimum and maximum melting temperature&lt;/div>&lt;div  class=\"tutorial_text\">DNA is a double stranded molecule that forms a double helix chape in its natural condition.  At a certain temperature a DNA doublle helix will unwind or 'melt.'  The temperature required for this depends in large part on the nucleotide pairing within the double helix, with C-G pairings requiring more energy (and therefore a higher tempurature) to 'melt' than A-T pairs.&lt;br>&lt;br>&lt;button onclick=\"generateTutorial(true, 2)\">Next&lt;/button>&lt;/div>&lt;/div>&lt;/p>"</span><span class="WHIT">
<span class='line'>778</span> </span><span class="WHIT">	  </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">	  </span><span class="NAME">tutorialHTML</span><span class="PUNC">=</span><span class="STRN">"&lt;p>&lt;div class=\"center\">&lt;img src=\"img/second_header.png\" class=\"tutorial_header\">&lt;/div>&lt;/div>&lt;div style=\"display:table;\">&lt;div style=\"float:right;\">&lt;img src=\"img/Codons_aminoacids_table_small.png\" height=\"211\" width=\"100\">&lt;/img>&lt;/div>&lt;div class=\"tutorial_title\">Minimum percentage of recoded nucleotides&lt;/div>&lt;div class=\"tutorial_text\">This parameter is the minimum change in nucleotids that you are requiring for your watermarks.  The purpose of recoding nuclotides during the watermarking phase is to insert stretches of DNA into the synthetic gene or genome that does not change any function (they code for the same amino acids and therefore the same proteins) but offers a target for you to examine to make sure you are working with your synthetic gene.&lt;br>&lt;br>&lt;button onclick=\"generateTutorial(true, 3)\">Next&lt;/button>&lt;/div>&lt;/div>&lt;/div>&lt;/p>"</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">	  </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>783</span> </span><span class="WHIT">	  </span><span class="NAME">tutorialHTML</span><span class="PUNC">=</span><span class="STRN">"&lt;p>&lt;div>&lt;img src=\"img/third_header.png\" class=\"tutorial_header\">&lt;/img>&lt;/div>&lt;div class=\"tutorial_title\">Smallest to largest amplification region allowed&lt;/div>&lt;div class=\"tutorial_text\">This parameter sets the range of the size that the amplification region flanked by the watermarks can be.  This includes the watermarks themselves.  Typically this is between 200 and 500 which is a large enough range to amplify successfully in PCR without being too large.  This can vary depending on the size of your gene or genome that you wish to watermark.&lt;div class=\"next_button\">&lt;br />&lt;button onclick=\"generateTutorial(true, 4)\">Next&lt;/button>&lt;/div>&lt;/div>&lt;/p>"</span><span class="WHIT">
<span class='line'>784</span> </span><span class="WHIT">	  </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>785</span> </span><span class="WHIT">	</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">	  </span><span class="COMM">// remove DIVs</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">	  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'light'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'hidden'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>788</span> </span><span class="WHIT">	  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'fade'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'hidden'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>789</span> </span><span class="WHIT">	  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'results_section'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'visible'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>790</span> </span><span class="WHIT">	  </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>791</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">  
<span class='line'>793</span>   </span><span class="COMM">// Change the lightbox HTML</span><span class="WHIT">
<span class='line'>794</span> </span><span class="WHIT">  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'light'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="PUNC">=</span><span class="NAME">tutorialHTML</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>795</span> </span><span class="WHIT">  
<span class='line'>796</span>   </span><span class="COMM">// Show the dark faded background and the lightbox</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'light'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.display</span><span class="PUNC">=</span><span class="STRN">'block'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>798</span> </span><span class="WHIT">  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'fade'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.display</span><span class="PUNC">=</span><span class="STRN">'block'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'light'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'visible'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">  </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'fade'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.visibility</span><span class="PUNC">=</span><span class="STRN">'visible'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>801</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>802</span> 
<span class='line'>803</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>804</span> </span><span class="COMM">// Generate Oops message if parameters appear to strict</span><span class="WHIT">
<span class='line'>805</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>806</span> 
<span class='line'>807</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">generateOops</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">oops_needed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">oops_needed</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">	  </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">	
<span class='line'>811</span> 	
<span class='line'>812</span> </span><span class="PUNC">}</span></pre></body></html>